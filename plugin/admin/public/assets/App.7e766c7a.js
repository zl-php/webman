var M=(n,y,r)=>new Promise((_,b)=>{var v=a=>{try{o(r.next(a))}catch(k){b(k)}},f=a=>{try{o(r.throw(a))}catch(k){b(k)}},o=a=>a.done?_(a.value):Promise.resolve(a.value).then(v,f);o((r=r.apply(n,y)).next())});import{dY as A,k as E,aG as R,a as U,dZ as O,cW as I,dV as V,cT as z,ce as N,cE as G,aI as m,o as t,h as p,j as w,p as u,t as h,aK as T,F as g,aJ as C,q as d,b2 as P,cH as j,bf as q,x}from"./index.656c725e.js";import{T as H}from"./index.d60da1cd.js";import{S as J}from"./index.2e5a1dae.js";import{T as K}from"./index.0183fbaa.js";import{B as W,u as Y}from"./useTable.f5c40803.js";import"./BasicForm.67047978.js";import{a as Z,b as S,g as Q}from"./common.6ce55d48.js";import X from"./Login.0aac6732.js";import{b as ee}from"./index.e8ce4467.js";import"./transButton.d84e11d0.js";import"./CopyOutlined.b755f8d6.js";import"./index.6e6030d1.js";import"./useForm.fec2986b.js";import"./index.687742b9.js";import"./index.cd81be35.js";import"./index.3120412e.js";import"./index.ddc16f9d.js";import"./useWindowSizeFn.2783558b.js";import"./useContentViewHeight.8799f330.js";import"./ArrowLeftOutlined.fc4e10b6.js";import"./index.28987d30.js";import"./_baseIteratee.d7866646.js";import"./index.4f3dd38a.js";import"./sortable.esm.c20789c1.js";import"./RedoOutlined.b54223ae.js";import"./FullscreenOutlined.52703f8e.js";import"./scrollTo.fd8c0855.js";import"./index.bd7662c1.js";import"./index.2cbc8967.js";import"./index.1f507897.js";import"./index.873c27ee.js";import"./index.38230a24.js";import"./uniqBy.73b96c75.js";import"./download.add46730.js";import"./index.2c103eba.js";import"./useLogin.d55d99c9.js";function te(n){let y,r=document.body;if(Reflect.has(n,"target")||Reflect.has(n,"props")){const o=n;y=o.props||{},r=o.target||document.body}else y=n;const _=A(y,void 0,!0);return[()=>{const o=E(r);!o||_.open(o)},()=>{_.close()},o=>{_.setTip(o)}]}const ne="/app/admin/plugin/app/list",oe="/app/admin/plugin/app/schema",se=U({components:{BasicTable:W,Tag:H,Switch:J,ModalLogin:X,DropdownButton:O,Menu:I,MenuItem:V,DownOutlined:z,TypographyText:K},setup(){const{createMessage:n}=x(),{success:y,error:r}=n;N();const[_,{openModal:b}]=ee(),[v,f]=te({tip:"\u5904\u7406\u4E2D..."});G(()=>M(this,null,function*(){L(yield Z(oe))}));const o=(l,s)=>{a("\u786E\u5B9A\u5378\u8F7D\uFF1F","",function(){B(l,s)})},a=(l,s,e)=>{j.confirm({centered:!0,title:()=>l,icon:()=>w(q),content:()=>w("div",{style:"color:red;"},s),onOk(){e()},class:"test"})};function k(l,s,e){return M(this,null,function*(){if(e!=s){v();try{const i=yield S("/app/admin/plugin/app/install",{name:l,version:s},{timeout:6e4});if(i.code==401){b();return}if(i.code){r(i.message);return}y("\u5B89\u88C5\u6210\u529F"),setTimeout(()=>{location.reload()},1e3)}catch(i){}finally{f()}}})}function B(l,s){return M(this,null,function*(){try{v(),yield S("/app/admin/plugin/app/uninstall",{name:l,version:s})}catch(e){f();return}f(),setTimeout(()=>{location.reload()},1e3),y("\u5378\u8F7D\u6210\u529F")})}function D(l){console.log(l)}const[F,{reload:$,setColumns:L}]=Y({api:Q(ne),bordered:!0,showTableSetting:!0});return{registerTable:F,reload:$,onStateChanged:D,install:k,uninstall:B,register:_,showConfirmUninstall:o}}}),ae={class:"p-4"},ie={key:0,style:{"text-align":"left"}},le=d("\u514D\u8D39"),pe=d("\u5378\u8F7D"),ue=d("\u5B89\u88C5");function re(n,y,r,_,b,v){const f=m("Tag"),o=m("Switch"),a=m("TypographyText"),k=m("a-button"),B=m("MenuItem"),D=m("Menu"),F=m("DownOutlined"),$=m("DropdownButton"),L=m("BasicTable"),l=m("ModalLogin");return t(),p("div",ae,[w(L,{onRegister:n.registerTable},{bodyCell:u(({column:s,record:e,text:i})=>[s.key==="title"?(t(),p("div",ie,h(i),1)):T("",!0),s.key==="author"?(t(),p(g,{key:1},[i==="\u5B98\u65B9"?(t(),C(f,{key:0,color:"green"},{default:u(()=>[d(h(i),1)]),_:2},1024)):(t(),p(g,{key:1},[d(h(i),1)],64))],64)):T("",!0),s.key==="state"?(t(),C(o,{key:2,"checked-children":"\u5F00\u542F","un-checked-children":"\u7981\u7528","default-checked":"",class:"extra",checked:e.state,"onUpdate:checked":c=>e.state=c,onChange:c=>n.onStateChanged(e)},null,8,["checked","onUpdate:checked","onChange"])):T("",!0),s.key==="version"?(t(),p(g,{key:3},[e.installed?(t(),p(g,{key:0},[d(h(e.installed),1)],64)):(t(),p(g,{key:1},[d(h(i),1)],64))],64)):T("",!0),s.key==="price"?(t(),p(g,{key:4},[i==0?(t(),C(a,{key:0,type:"success"},{default:u(()=>[le]),_:1})):(t(),C(a,{key:1,type:"danger"},{default:u(()=>[d(h(i)+"\xA5",1)]),_:2},1024))],64)):T("",!0),s.key==="installed"?(t(),p(g,{key:5},[e.installed?(t(),p(g,{key:0},[e.name!=="admin"?(t(),C(k,{key:0,type:"danger",size:"small",onClick:c=>n.showConfirmUninstall(e.name,e.installed)},{default:u(()=>[pe]),_:2},1032,["onClick"])):T("",!0)],64)):(t(),C(k,{key:1,type:"success",size:"small",onClick:c=>n.install(e.name,e.version)},{default:u(()=>[ue]),_:2},1032,["onClick"])),e.installed&&e.releases&&e.releases.length>1?(t(),C($,{key:2,onClick:c=>n.install(e.name,e.version,e.installed),size:"small",type:e.version===e.installed?"info":"success"},{overlay:u(()=>[w(D,null,{default:u(()=>[(t(!0),p(g,null,P(e.releases,c=>(t(),C(B,{key:c,disabled:c===e.installed,onClick:ce=>n.install(e.name,c,e.installed)},{default:u(()=>[d(h(c),1)]),_:2},1032,["disabled","onClick"]))),128))]),_:2},1024)]),icon:u(()=>[w(F)]),default:u(()=>[d(h(e.version===e.installed?"\u964D\u7EA7":"\u5347\u7EA7")+" ",1)]),_:2},1032,["onClick","type"])):T("",!0)],64)):T("",!0)]),_:1},8,["onRegister"]),w(l,{onRegister:n.register,height:350,width:450},null,8,["onRegister"])])}var We=R(se,[["render",re]]);export{We as default};
